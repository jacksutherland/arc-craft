{"version":3,"file":"fields.js","mappings":"YAAA,IAAUA,EAGFC,EAHED,EA2HPE,OAxHKD,EAAcE,QAAQC,KAAKC,OAAO,CAClCC,QAAS,KACTC,eAAgB,KAEhBC,KAAM,WAAW,WACbC,KAAKH,QAAUN,EAAE,WACjBS,KAAKF,eAAiBE,KAAKH,QAAQI,KAAK,eACxCD,KAAKE,YAAYX,EAAE,gBAAiB,WAAY,eAEhD,IAAIY,EAAoBZ,EAAE,qBAEtBY,EAAkBC,SACJD,EAAkBE,KAAK,WAE7BC,SAASC,eAAiB,SAAAC,GAG9B,OAFajB,EAAEiB,GAAMH,KAAK,WAGtB,IAAK,SACD,EAAKI,sBACL,MAEJ,IAAK,SACD,EAAKC,0BAQzBC,YAAa,WAAW,WAChBC,EAAOZ,KAAKa,mBAAmB,IAEnC,GAAID,EAAM,CACN,IAAIP,EAAO,CACPO,KAAMA,GAGVE,MAAMC,kBAAkB,oBAAqBV,GAAM,SAACW,EAAUC,GAC1D,GAAmB,YAAfA,EACA,GAAID,EAASE,QACTC,SAASC,KAAON,MAAMO,OAAO,mBAAqBL,EAASM,MAAMC,SAC9D,GAAIP,EAASQ,OAAQ,CACxB,IAAIA,EAAS,EAAKC,cAAcT,EAASQ,QACzCE,MAAMZ,MAAMa,EAAE,MAAO,+BAAiC,OAASH,EAAOI,KAAK,YAE3Ed,MAAMe,GAAGC,oBAO7BrB,oBAAqB,WAAW,WACxBsB,EAAU/B,KAAKF,eAAekC,OAC9BC,EAAUjC,KAAKa,mBAAmBkB,GAEtC,GAAIE,GAAWA,IAAYF,EAAS,CAChC,IAAI1B,EAAO,CACPkB,GAAIvB,KAAKF,eAAeO,KAAK,MAC7BO,KAAMqB,GAGVnB,MAAMC,kBAAkB,oBAAqBV,GAAM,SAACW,EAAUC,GAC1D,GAAmB,YAAfA,EACA,GAAID,EAASE,QACT,EAAKpB,eAAekC,KAAKhB,EAASM,MAAMV,MACxCE,MAAMe,GAAGK,cAAcpB,MAAMa,EAAE,MAAO,wBACnC,GAAIX,EAASQ,OAAQ,CACxB,IAAIA,EAAS,EAAKC,cAAcT,EAASQ,QACzCE,MAAMZ,MAAMa,EAAE,MAAO,+BAAiC,OAASH,EAAOI,KAAK,YAE3Ed,MAAMe,GAAGC,oBAO7BjB,mBAAoB,SAASkB,GACzB,OAAOI,OAAOrB,MAAMa,EAAE,MAAO,uCAAwCI,IAGzErB,oBAAqB,WACjB,GAAI0B,QAAQtB,MAAMa,EAAE,MAAO,mEAAoE,CAC3F,IAAItB,EAAO,CACPkB,GAAIvB,KAAKF,eAAeO,KAAK,OAGjCS,MAAMC,kBAAkB,sBAAuBV,GAAM,SAACW,EAAUC,GACzC,YAAfA,IACID,EAASE,QACTC,SAASC,KAAON,MAAMO,OAAO,mBAE7BP,MAAMe,GAAGC,qBAO7BL,cAAe,SAASY,GACpB,IAAIb,EAAS,GAEb,IAAK,IAAIc,KAAaD,EACbA,EAAeE,eAAeD,KAInCd,EAASA,EAAOgB,OAAOH,EAAeC,KAG1C,OAAOd,KAIf9B,QAAQ+C,KAAKC,OAAM,WACf5B,MAAMtB,YAAc,IAAIA,K","sources":["webpack:///./fields.js"],"sourcesContent":["(function($) {\n    /** global: Craft */\n    /** global: Garnish */\n    var FieldsAdmin = Garnish.Base.extend({\n        $groups: null,\n        $selectedGroup: null,\n\n        init: function() {\n            this.$groups = $('#groups');\n            this.$selectedGroup = this.$groups.find('a.sel:first');\n            this.addListener($('#newgroupbtn'), 'activate', 'addNewGroup');\n\n            var $groupSettingsBtn = $('#groupsettingsbtn');\n\n            if ($groupSettingsBtn.length) {\n                var menuBtn = $groupSettingsBtn.data('menubtn');\n\n                menuBtn.settings.onOptionSelect = elem => {\n                    var action = $(elem).data('action');\n\n                    switch (action) {\n                        case 'rename': {\n                            this.renameSelectedGroup();\n                            break;\n                        }\n                        case 'delete': {\n                            this.deleteSelectedGroup();\n                            break;\n                        }\n                    }\n                };\n            }\n        },\n\n        addNewGroup: function() {\n            var name = this.promptForGroupName('');\n\n            if (name) {\n                var data = {\n                    name: name\n                };\n\n                Craft.postActionRequest('fields/save-group', data, (response, textStatus) => {\n                    if (textStatus === 'success') {\n                        if (response.success) {\n                            location.href = Craft.getUrl('settings/fields/' + response.group.id);\n                        } else if (response.errors) {\n                            var errors = this.flattenErrors(response.errors);\n                            alert(Craft.t('app', 'Could not create the group:') + \"\\n\\n\" + errors.join(\"\\n\"));\n                        } else {\n                            Craft.cp.displayError();\n                        }\n                    }\n                });\n            }\n        },\n\n        renameSelectedGroup: function() {\n            var oldName = this.$selectedGroup.text(),\n                newName = this.promptForGroupName(oldName);\n\n            if (newName && newName !== oldName) {\n                var data = {\n                    id: this.$selectedGroup.data('id'),\n                    name: newName\n                };\n\n                Craft.postActionRequest('fields/save-group', data, (response, textStatus) => {\n                    if (textStatus === 'success') {\n                        if (response.success) {\n                            this.$selectedGroup.text(response.group.name);\n                            Craft.cp.displayNotice(Craft.t('app', 'Group renamed.'));\n                        } else if (response.errors) {\n                            var errors = this.flattenErrors(response.errors);\n                            alert(Craft.t('app', 'Could not rename the group:') + \"\\n\\n\" + errors.join(\"\\n\"));\n                        } else {\n                            Craft.cp.displayError();\n                        }\n                    }\n                });\n            }\n        },\n\n        promptForGroupName: function(oldName) {\n            return prompt(Craft.t('app', 'What do you want to name the group?'), oldName);\n        },\n\n        deleteSelectedGroup: function() {\n            if (confirm(Craft.t('app', 'Are you sure you want to delete this group and all its fields?'))) {\n                var data = {\n                    id: this.$selectedGroup.data('id')\n                };\n\n                Craft.postActionRequest('fields/delete-group', data, (response, textStatus) => {\n                    if (textStatus === 'success') {\n                        if (response.success) {\n                            location.href = Craft.getUrl('settings/fields');\n                        } else {\n                            Craft.cp.displayError();\n                        }\n                    }\n                });\n            }\n        },\n\n        flattenErrors: function(responseErrors) {\n            var errors = [];\n\n            for (var attribute in responseErrors) {\n                if (!responseErrors.hasOwnProperty(attribute)) {\n                    continue;\n                }\n\n                errors = errors.concat(responseErrors[attribute]);\n            }\n\n            return errors;\n        }\n    });\n\n    Garnish.$doc.ready(function() {\n        Craft.FieldsAdmin = new FieldsAdmin();\n    });\n})(jQuery);\n"],"names":["$","FieldsAdmin","jQuery","Garnish","Base","extend","$groups","$selectedGroup","init","this","find","addListener","$groupSettingsBtn","length","data","settings","onOptionSelect","elem","renameSelectedGroup","deleteSelectedGroup","addNewGroup","name","promptForGroupName","Craft","postActionRequest","response","textStatus","success","location","href","getUrl","group","id","errors","flattenErrors","alert","t","join","cp","displayError","oldName","text","newName","displayNotice","prompt","confirm","responseErrors","attribute","hasOwnProperty","concat","$doc","ready"],"sourceRoot":""}